<!DOCTYPE HTML>
<html lang="en">
<link rel="stylesheet" href="main.css" type="text/css" />

    <head>
        <title>Hometown</title>
        <script src="./javascript/canvas.js" defer></script>
        <script src="./javascript/prompt.js" defer></script>
    </head>

    <body>
        
        <!--Main Page screen-->
        <div id="mainPage">
            <div align="center">

                <h1>
                    Welcome to ... (game name)
                </h1>
        
            </div>
            <div align="center">

                <h2>
                    Start a new game?
                </h2>
        
                <button class="new_button" onclick="createButtonClicked()">
                    Make new game!
                </button>

            </div>

            <div align="center">

                <h2>
                    Join an existing game?
                </h2>

                <button class="join_button" id="mainJoinButton" onclick="mainJoinButtonClicked()">
                    Join existing game!
                </button>
        
            </div>

            <div align="center">

                <h2>
                    Rules:
                </h2>

                <p>
                    blah blah blah blah blah blahblah blah blahblah blah blahblah 
                    blah blahblah blah blahblah blah blahblah blah blahblah blah 
                    blahblah blah blahblah blah blahblah blah blah
                </p>
        
            </div>
        </div>

        <!--Transition join screen-->
        <div id="joinPage" style="display:none">
            <div align="center">

                <h1>
                    Join a new game!
                </h1>
        
                
            </div>

            <div align="center">
    
                <h2>
                    Enter game code:
                </h2>
        
                <input type="text" id="lobbyIDInput" size = 20 maxlength=35 value="">
    
    
            </div>
    
            <div align="center">
    
                <h2>
                    Enter your name:
                </h2>
    
                <input type="text" id="usernameInput" size = 20 maxlength=35 value="">
        
            </div>
            <br></br>
        
            <div align="center">
    
                <button class="join_button" id="joinJoinButton" onclick="joinJoinButtonClicked()">
                    Join!
                </button>
            
            </div>
        </div>

        <!--Initial Lobby screen-->
        <div id="lobbyPage" style="display:none">
            <div align="center">

                <h1>
                    Welcome to the Game Lobby!
                </h1>
        
            </div>
            <div style = "position:relative; left:150px; top:80px">
    
                <h2>
                    Game Code
                </h2>
            
            </div>
    
            <div style = "position:relative; left:135px; top:75px">
    
                <div class="boxed" id="lobbyIDDisplay"></div>
    
            </div>
    
            <div style = "position:relative; left:150px; top:175px">
                
                <button class="start_button" onclick="StartGameButtonClicked()">
                    Start Game!
                </button>
    
            </div>
                
           
    
            <div style = "position:relative; left:600px; top:-75px">
               
                <h2>Waiting Room:</h2>
            
            </div>
            
            <div style = "position:relative; left:550px; top:-75px">
    
                <div class="lobbybox" id="playerList">
<<<<<<< HEAD
                    
=======
>>>>>>> 7dba09cf01cf1490d50e06df4d5cf3f1296249fb
                </div>
    
            </div>
        </div>
    

        <!--Prompt screen-->
        <div id="promptPage" style="display:none">
            <div class="timer">
                <p>Timer Location</p>
            </div>
            <p>
                Text for giving prompt inspiration
            </p>
            <textarea name="text" id="prompt" rows="5"  wrap="soft" placeholder="Enter Prompt Here"> </textarea>
            <!-- <input type="text" class="input_prompt" placeholder="Enter Prompt Here" /> -->
            <button class="enter_button" onclick="enterPromptButtonClicked()">Enter</button>
        </div>


        <!--Waiting for next round screen-->
        <div id="waitingNextRoundPage" style="display:none">
            <div class="waiting_entertain">
                <!-- Contents tbd -->
            </div>
            <div class="waiting_players">
                <p>
                    Waiting room
                </p>
            </div>
        </div>


        <!--Canvas screen-->
        <div id="canvasPage" style="display:none">
            <p>Draw the following: </p>
            <p>*Funny Prompt*</p>
          
          <!--Set up canvas & quick version of setting up fabric-->
            <canvas id="canvas" width="1000" height="500"></canvas>
            <script src="https://cdn.jsdelivr.net/npm/fabric"></script>
          
            <label for="colorpicker">Change Color:</label>
            <input type="color" id="colorpicker" value="#0000ff" oninput="changeColor()">
          
            <label for="sizepicker">Change Brush Size:</label>
            <input type="number" id="sizepicker" min="1" value="5" oninput="changeSize()">
          
            <script src="javascript/canvas.js"></script>
              
            <button class="enter_button" onclick="enterCanvasButtonClicked()">Enter</button>
        </div>




        <script src="/socket.io/socket.io.js"></script>
        <script>
            const socket = io();
            
            /* HTML elements */
            
            const screenViews = {
              mainPage: document.getElementById("mainPage"),
              joinPage: document.getElementById("joinPage"),
              lobbyPage: document.getElementById("lobbyPage"),
              promptPage: document.getElementById("promptPage"),
              waitingNextRoundPage: document.getElementById("waitingNextRoundPage"),
              canvasPage: document.getElementById("canvasPage")
            };

            const lobbyIDInput = document.getElementById("lobbyIDInput");
            const usernameInput = document.getElementById("usernameInput");
            const lobbyIDDisplay = document.getElementById("lobbyIDDisplay");
<<<<<<< HEAD
            const playerList = document.getElementById("playerList")
=======
            const playerList = document.getElementById("playerList");
            const prompt = document.getElementById("prompt");
>>>>>>> 7dba09cf01cf1490d50e06df4d5cf3f1296249fb
            
            /* Utility Functions */
            
            function switchView(newViewName){
              for (let [viewName, view] of Object.entries(screenViews)) {
                if (viewName === newViewName) {
                  view.style.display = 'block';
                } 
                else {
                  view.style.display = 'none';
                }
              }
            }
            
            
            /* Game Functionality */
            
            /* Create a new game. Emit newGame event. */
            function createButtonClicked() {
                socket.emit('createClicked');
            }
            
            
            /* The join button was clicked on the initial main screen */
            function mainJoinButtonClicked() {
                switchView("joinPage");
            }

            /* The join button was clicked after entering the game code and name of player */
            function joinJoinButtonClicked() {
                socket.emit("joinClicked", usernameInput.value, lobbyIDInput.value);
            }

            // The start game button was clicked
            function StartGameButtonClicked() {
                socket.emit("startGameClicked", usernameInput.value, lobbyIDInput.value);
            }

            // The enter prompt button was clicked
            function enterPromptButtonClicked() {
                socket.emit("promptEntered", usernameInput.value, lobbyIDInput.value, prompt.value);
            }

            // The enter canvas button was clicked
            function enterCanvasButtonClicked() {
                socket.emit("canvasEntered", usernameInput.value, lobbyIDInput.value); //add canvas data
            }


            /* Socket Functionality */

            socket.on("roomCreated", function(lobbyID) {
                switchView("lobbyPage");

                lobbyIDDisplay.innerHTML = lobbyID;
            });


            socket.on("playerToWaitingRoom", function(players) {
                switchView("lobbyPage"); //Will be a different page
<<<<<<< HEAD
                console.log('In lobbyPage:', players);
            
                playerUsernames = players.map((player) => player.username);
                console.log('playerUsernames:', playerUsernames.join('<br>'));
                playerList.innerHTML = playerUsernames.join('<br>');
=======
                
                socket.emit("getPlayerNames", players);
            });

            socket.on("showPlayerNames", function(players) {
                playerList.innerHTML = players;
>>>>>>> 7dba09cf01cf1490d50e06df4d5cf3f1296249fb
            });


            socket.on("playerToPrompt", function() {
                switchView("promptPage");
            });


            socket.on("playerToWaitingNextRound", function() {
                switchView("waitingNextRoundPage");
            });
            

            socket.on("playerToCanvas", function() {
                switchView("canvasPage");
            });

        </script>
    </body>
</html>
